<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø±Ø¨Ø­ÙŠ â€” Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„ØªØ¬Ø§Ø± Ø§Ù„Ù…ØºØ§Ø±Ø¨Ø©</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts: Cairo + Playfair -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root {
      --gold: #f5c842;
      --gold-dim: #c9a227;
      --teal: #00c9b1;
      --teal-dim: #00a090;
      --danger: #ff4d6d;
      --bg-deep: #080c14;
      --bg-card: rgba(15, 22, 40, 0.75);
      --border-glass: rgba(255,255,255,0.07);
      --text-muted: #8899b0;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Cairo', 'Tajawal', sans-serif;
      background: var(--bg-deep);
      color: #e8f0ff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* â”€â”€â”€ Background mesh â”€â”€â”€ */
    .bg-mesh {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background:
        radial-gradient(ellipse 80% 60% at 20% 10%, rgba(0,201,177,0.12) 0%, transparent 60%),
        radial-gradient(ellipse 60% 50% at 80% 90%, rgba(245,200,66,0.10) 0%, transparent 55%),
        radial-gradient(ellipse 50% 40% at 60% 30%, rgba(110,60,220,0.08) 0%, transparent 50%),
        var(--bg-deep);
    }

    /* â”€â”€â”€ Glass card â”€â”€â”€ */
    .glass {
      background: var(--bg-card);
      border: 1px solid var(--border-glass);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    /* â”€â”€â”€ Glow effects â”€â”€â”€ */
    .glow-teal { box-shadow: 0 0 30px rgba(0,201,177,0.25), 0 0 60px rgba(0,201,177,0.1); }
    .glow-gold  { box-shadow: 0 0 30px rgba(245,200,66,0.25), 0 0 60px rgba(245,200,66,0.1); }
    .text-glow-gold { text-shadow: 0 0 20px rgba(245,200,66,0.6); }

    /* â”€â”€â”€ Gradient text â”€â”€â”€ */
    .grad-text {
      background: linear-gradient(135deg, var(--gold) 0%, var(--teal) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* â”€â”€â”€ Buttons â”€â”€â”€ */
    .btn-primary {
      background: linear-gradient(135deg, var(--teal) 0%, #00a090 100%);
      color: #fff;
      font-weight: 700;
      border-radius: 12px;
      padding: 12px 28px;
      font-size: 16px;
      letter-spacing: 0.3px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    .btn-primary::after {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.1);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .btn-primary:hover::after { opacity: 1; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(0,201,177,0.4); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    .btn-gold {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dim) 100%);
      color: #080c14;
      font-weight: 800;
      border-radius: 12px;
      padding: 12px 28px;
      font-size: 16px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }
    .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(245,200,66,0.4); }

    .btn-outline {
      background: transparent;
      border: 1.5px solid var(--border-glass);
      color: #e8f0ff;
      border-radius: 12px;
      padding: 11px 24px;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-outline:hover { border-color: var(--teal); color: var(--teal); }

    /* â”€â”€â”€ Inputs â”€â”€â”€ */
    .input-field {
      width: 100%;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 11px 16px;
      color: #e8f0ff;
      font-family: 'Cairo', sans-serif;
      font-size: 15px;
      outline: none;
      transition: border-color 0.3s, box-shadow 0.3s;
      direction: rtl;
    }
    .input-field:focus {
      border-color: var(--teal);
      box-shadow: 0 0 0 3px rgba(0,201,177,0.15);
    }
    .input-field::placeholder { color: var(--text-muted); }

    /* â”€â”€â”€ Range slider â”€â”€â”€ */
    input[type=range] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 4px;
      background: rgba(255,255,255,0.1);
      outline: none;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px; height: 18px;
      border-radius: 50%;
      background: var(--teal);
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0,201,177,0.5);
    }

    /* â”€â”€â”€ Tabs â”€â”€â”€ */
    .tab-btn {
      padding: 8px 20px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
    }
    .tab-btn.active {
      background: rgba(0,201,177,0.15);
      border-color: var(--teal);
      color: var(--teal);
      font-weight: 600;
    }

    /* â”€â”€â”€ Result cards â”€â”€â”€ */
    .result-card {
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .result-card::before {
      content: '';
      position: absolute;
      inset: 0;
      opacity: 0.07;
      border-radius: 16px;
    }
    .result-card.profit::before  { background: var(--teal); }
    .result-card.loss::before    { background: var(--danger); }
    .result-card.neutral::before { background: var(--gold); }

    /* â”€â”€â”€ Modal â”€â”€â”€ */
    .modal-overlay {
      position: fixed; inset: 0; z-index: 1000;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(8px);
      display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none;
      transition: opacity 0.3s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: all; }
    .modal-box {
      width: 440px; max-width: 95vw;
      transform: translateY(30px) scale(0.97);
      transition: transform 0.35s cubic-bezier(.34,1.56,.64,1), opacity 0.3s;
      opacity: 0;
    }
    .modal-overlay.open .modal-box { transform: translateY(0) scale(1); opacity: 1; }

    /* â”€â”€â”€ AI bubble â”€â”€â”€ */
    .ai-bubble {
      background: rgba(0,201,177,0.08);
      border: 1px solid rgba(0,201,177,0.2);
      border-radius: 16px;
      padding: 20px;
      position: relative;
      white-space: pre-wrap;
      line-height: 1.9;
    }
    .ai-bubble::before {
      content: 'ğŸ¤–';
      position: absolute;
      top: -14px; right: 20px;
      font-size: 22px;
    }

    /* â”€â”€â”€ Token badge â”€â”€â”€ */
    .token-badge {
      background: rgba(245,200,66,0.15);
      border: 1px solid rgba(245,200,66,0.35);
      border-radius: 20px;
      padding: 4px 14px;
      font-size: 13px;
      color: var(--gold);
      font-weight: 600;
    }

    /* â”€â”€â”€ Navbar â”€â”€â”€ */
    .navbar {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      background: rgba(8,12,20,0.85);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-glass);
    }

    /* â”€â”€â”€ Hero â”€â”€â”€ */
    .hero-badge {
      display: inline-flex; align-items: center; gap: 8px;
      background: rgba(0,201,177,0.12);
      border: 1px solid rgba(0,201,177,0.3);
      border-radius: 30px;
      padding: 6px 18px;
      font-size: 13px; color: var(--teal);
      margin-bottom: 24px;
    }

    /* â”€â”€â”€ Stat counter â”€â”€â”€ */
    .stat-item { text-align: center; }
    .stat-num { font-size: 2.5rem; font-weight: 900; line-height: 1; }
    .stat-label { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

    /* â”€â”€â”€ Feature card â”€â”€â”€ */
    .feature-card {
      border-radius: 20px;
      padding: 28px;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .feature-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    /* â”€â”€â”€ Scrollbar â”€â”€â”€ */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

    /* â”€â”€â”€ Animations â”€â”€â”€ */
    @keyframes fadeUp {
      from { opacity:0; transform: translateY(30px); }
      to   { opacity:1; transform: translateY(0); }
    }
    @keyframes pulse-ring {
      0%,100% { transform: scale(1); opacity: 0.6; }
      50%      { transform: scale(1.05); opacity: 1; }
    }
    @keyframes float {
      0%,100% { transform: translateY(0px); }
      50%      { transform: translateY(-12px); }
    }
    @keyframes spin-slow { to { transform: rotate(360deg); } }
    .fade-up    { animation: fadeUp 0.7s ease forwards; }
    .float-anim { animation: float 4s ease-in-out infinite; }

    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }

    /* â”€â”€â”€ Typing cursor â”€â”€â”€ */
    .typing::after {
      content: '|';
      animation: blink 0.8s step-end infinite;
      color: var(--teal);
    }
    @keyframes blink { 50% { opacity:0; } }

    /* â”€â”€â”€ Toast â”€â”€â”€ */
    #toast {
      position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
      background: #1a2540;
      border: 1px solid var(--border-glass);
      border-radius: 12px; padding: 14px 28px;
      font-size: 14px; z-index: 9999;
      transition: transform 0.4s cubic-bezier(.34,1.56,.64,1);
    }
    #toast.show { transform: translateX(-50%) translateY(0); }

    /* â”€â”€â”€ Section divider â”€â”€â”€ */
    .section-divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
      margin: 0 auto;
    }

    /* table style */
    .breakdown-table { width: 100%; border-collapse: collapse; font-size: 14px; }
    .breakdown-table th { color: var(--text-muted); font-weight: 600; padding: 10px 14px; text-align: right; border-bottom: 1px solid var(--border-glass); }
    .breakdown-table td { padding: 10px 14px; border-bottom: 1px solid rgba(255,255,255,0.04); }
    .breakdown-table tr:last-child td { border-bottom: none; }

    /* referral box */
    .referral-box {
      background: rgba(245,200,66,0.06);
      border: 1px dashed rgba(245,200,66,0.3);
      border-radius: 14px;
      padding: 16px 20px;
    }
    .referral-link {
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      padding: 8px 14px;
      font-size: 13px;
      color: var(--teal);
      font-family: monospace;
      word-break: break-all;
    }

    /* loading dots */
    .loading-dots span {
      display: inline-block; width: 8px; height: 8px;
      border-radius: 50%; background: var(--teal);
      margin: 0 3px;
      animation: bounce 1.2s infinite;
    }
    .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce { 0%,80%,100% { transform: scale(0.6); opacity:0.4; } 40% { transform: scale(1); opacity:1; } }

    /* profit meter */
    .profit-meter { height: 10px; background: rgba(255,255,255,0.07); border-radius: 5px; overflow: hidden; }
    .profit-meter-fill { height: 100%; border-radius: 5px; transition: width 1s ease; }
  </style>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: { cairo: ['Cairo','Tajawal','sans-serif'] },
        }
      }
    }
  </script>
</head>

<body class="dark font-cairo">

<!-- â–‘â–‘â–‘ BACKGROUND â–‘â–‘â–‘ -->
<div class="bg-mesh"></div>

<!-- â–‘â–‘â–‘ TOAST â–‘â–‘â–‘ -->
<div id="toast">Ø±Ø³Ø§Ù„Ø©</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AUTH MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="authModal" class="modal-overlay" onclick="handleModalOverlayClick(event)">
  <div class="modal-box glass rounded-3xl p-8 shadow-2xl">
    <div class="flex justify-between items-center mb-8">
      <h2 class="text-2xl font-black grad-text" id="authTitle">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <button onclick="closeModal('authModal')" class="w-9 h-9 rounded-full flex items-center justify-center hover:bg-white/10 transition text-gray-400 hover:text-white text-xl">âœ•</button>
    </div>

    <!-- Tabs -->
    <div class="flex gap-2 mb-6 bg-white/5 rounded-xl p-1">
      <button class="tab-btn active flex-1" id="tab-login" onclick="switchAuthTab('login')">Ø¯Ø®ÙˆÙ„</button>
      <button class="tab-btn flex-1" id="tab-signup" onclick="switchAuthTab('signup')">Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
    </div>

    <form id="authForm" onsubmit="handleAuth(event)">
      <div id="nameField" class="mb-4 hidden">
        <label class="block text-sm text-gray-400 mb-2">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
        <input type="text" id="authName" class="input-field" placeholder="Ù…Ø­Ù…Ø¯ Ø£Ù…ÙŠÙ†" />
      </div>
      <div class="mb-4">
        <label class="block text-sm text-gray-400 mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input type="email" id="authEmail" class="input-field" placeholder="you@example.com" required />
      </div>
      <div class="mb-6">
        <label class="block text-sm text-gray-400 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="authPassword" class="input-field" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />
      </div>
      <div id="refField" class="mb-5 hidden">
        <label class="block text-sm text-gray-400 mb-2">ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input type="text" id="refCode" class="input-field" placeholder="REF-XXXX" />
      </div>
      <button type="submit" id="authSubmit" class="btn-primary w-full text-lg py-3">
        <span id="authBtnText">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
      </button>
    </form>

    <p class="text-center text-sm text-gray-500 mt-5">
      Ø¨Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ <a href="#" class="text-teal-400 hover:underline">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
    </p>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NAVBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="navbar px-6 py-4">
  <div class="max-w-7xl mx-auto flex items-center justify-between">
    <!-- Logo -->
    <a href="#" class="flex items-center gap-3" onclick="showSection('landing')">
      <div class="w-9 h-9 rounded-xl flex items-center justify-center text-xl" style="background: linear-gradient(135deg,var(--teal),var(--gold))">ğŸ“Š</div>
      <span class="text-xl font-black grad-text">Ø±Ø¨Ø­ÙŠ</span>
    </a>

    <!-- Nav links (desktop) -->
    <div class="hidden md:flex items-center gap-6 text-sm">
      <a href="#features" class="text-gray-400 hover:text-white transition">Ø§Ù„Ù…ÙŠØ²Ø§Øª</a>
      <a href="#pricing" class="text-gray-400 hover:text-white transition">Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
      <button onclick="showSection('calculator')" class="text-gray-400 hover:text-white transition" id="calcNavBtn">Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</button>
    </div>

    <!-- Auth area -->
    <div class="flex items-center gap-3">
      <div id="navGuest" class="flex items-center gap-3">
        <button class="btn-outline text-sm py-2 px-4" onclick="openModal('authModal','login')">Ø¯Ø®ÙˆÙ„</button>
        <button class="btn-primary text-sm py-2 px-4" onclick="openModal('authModal','signup')">Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ø§Ù‹</button>
      </div>
      <div id="navUser" class="hidden items-center gap-3">
        <span class="token-badge">ğŸª™ <span id="navTokens">100</span> Ø±ØµÙŠØ¯</span>
        <div class="relative group">
          <button class="w-9 h-9 rounded-full bg-gradient-to-br from-teal-500 to-yellow-400 flex items-center justify-center text-black font-black text-sm cursor-pointer" id="navAvatar">Ù…</button>
          <div class="absolute top-full left-0 mt-2 w-48 glass rounded-2xl shadow-2xl overflow-hidden opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto transition-opacity z-50">
            <div class="px-4 py-3 border-b border-white/5">
              <p class="text-sm font-semibold" id="navUserEmail">user@example.com</p>
            </div>
            <button class="w-full text-right px-4 py-3 text-sm hover:bg-white/5 transition" onclick="showSection('calculator')">ğŸ“Š Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</button>
            <button class="w-full text-right px-4 py-3 text-sm hover:bg-white/5 transition" onclick="showSection('dashboard')">ğŸ“ˆ Ù„ÙˆØ­ØªÙŠ</button>
            <button class="w-full text-right px-4 py-3 text-sm hover:bg-white/5 transition" onclick="showReferral()">ğŸ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</button>
            <button class="w-full text-right px-4 py-3 text-sm text-red-400 hover:bg-white/5 transition" onclick="handleSignOut()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LANDING PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="landingSection">

  <!-- HERO -->
  <div class="min-h-screen flex items-center justify-center px-6 pt-24 pb-16 relative">
    <!-- Floating decorative elements -->
    <div class="absolute top-32 right-10 w-72 h-72 rounded-full opacity-10 float-anim" style="background: radial-gradient(circle, var(--teal), transparent 70%);"></div>
    <div class="absolute bottom-20 left-10 w-56 h-56 rounded-full opacity-8 float-anim" style="background: radial-gradient(circle, var(--gold), transparent 70%); animation-delay: 2s;"></div>

    <div class="max-w-5xl mx-auto text-center relative z-10">
      <!-- Badge -->
      <div class="hero-badge fade-up opacity-0">
        <span class="w-2 h-2 rounded-full bg-teal-400 inline-block" style="animation: pulse-ring 2s infinite"></span>
        Ù…Ø®ØµØµ Ù„Ù„ØªØ¬Ø§Ø± Ø§Ù„Ù…ØºØ§Ø±Ø¨Ø© ğŸ‡²ğŸ‡¦
      </div>

      <!-- Headline -->
      <h1 class="text-5xl md:text-7xl font-black leading-tight mb-6 fade-up opacity-0 delay-1" style="line-height:1.2;">
        Ø§Ø­Ù…Ù Ø£Ø±Ø¨Ø§Ø­Ùƒ Ù…Ù†
        <br/>
        <span class="grad-text text-glow-gold">Ø¶ÙŠØ§Ø¹ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</span>
      </h1>

      <p class="text-xl text-gray-400 max-w-2xl mx-auto mb-10 fade-up opacity-0 delay-2" style="line-height:2;">
        Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ø§Ù„ØªÙŠ ØªØ­Ø³Ø¨ <strong class="text-white">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</strong> Ø¨Ø¹Ø¯ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ØŒ Ø§Ù„Ø´Ø­Ù†ØŒ ÙˆÙ†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª.
        Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªÙˆØµÙŠØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© ÙÙˆØ±ÙŠØ© Ù…Ù† Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªØ­Ø³ÙŠÙ† Ù‡Ø§Ù…Ø´ Ø±Ø¨Ø­Ùƒ.
      </p>

      <div class="flex flex-col sm:flex-row gap-4 justify-center fade-up opacity-0 delay-3">
        <button class="btn-gold text-lg px-10 py-4 rounded-2xl" onclick="handleCTAClick()">
          ğŸš€ Ø§Ø­Ø³Ø¨ Ø±Ø¨Ø­Ùƒ Ù…Ø¬Ø§Ù†Ø§Ù‹
        </button>
        <a href="#features" class="btn-outline text-lg px-8 py-4 rounded-2xl">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ</a>
      </div>

      <!-- Stats -->
      <div class="grid grid-cols-3 gap-8 mt-20 fade-up opacity-0 delay-4">
        <div class="stat-item">
          <div class="stat-num grad-text">+2000</div>
          <div class="stat-label">ØªØ§Ø¬Ø± Ù†Ø´Ø·</div>
        </div>
        <div class="stat-item">
          <div class="stat-num" style="color:var(--gold)">98%</div>
          <div class="stat-label">Ø¯Ù‚Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</div>
        </div>
        <div class="stat-item">
          <div class="stat-num" style="color:var(--teal)">35%</div>
          <div class="stat-label">Ù…ØªÙˆØ³Ø· ØªØ­Ø³Ù† Ø§Ù„Ø±Ø¨Ø­ÙŠØ©</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FEATURES -->
  <div id="features" class="py-20 px-6">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-16">
        <h2 class="text-4xl font-black mb-4">Ù„Ù…Ø§Ø°Ø§ <span class="grad-text">Ø±Ø¨Ø­ÙŠ</span>ØŸ</h2>
        <p class="text-gray-400 text-lg">Ø£Ø¯ÙˆØ§Øª Ù„Ø§ ØªÙˆÙØ±Ù‡Ø§ Ø£ÙŠ Ù…Ù†ØµØ© Ø¹Ø±Ø¨ÙŠØ© Ø£Ø®Ø±Ù‰</p>
      </div>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="feature-card glass">
          <div class="text-4xl mb-5">ğŸ§®</div>
          <h3 class="text-xl font-bold mb-3">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø¹Ø¯Ù‘Ù„Ø©</h3>
          <p class="text-gray-400 leading-relaxed">Ù†Ø­Ø³Ø¨ Ø±Ø¨Ø­Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ø¹ Ø§Ø­ØªØ³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©ØŒ Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (TVA)ØŒ ÙˆØªÙƒØ§Ù„ÙŠÙ Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„ØªØ¹Ø¨Ø¦Ø©.</p>
        </div>
        <div class="feature-card glass" style="border-color: rgba(0,201,177,0.2)">
          <div class="text-4xl mb-5">ğŸ¤–</div>
          <h3 class="text-xl font-bold mb-3">Ù…Ø³ØªØ´Ø§Ø± AI ÙÙˆØ±ÙŠ</h3>
          <p class="text-gray-400 leading-relaxed">ÙŠØ­Ù„Ù„ Ù†ØªØ§Ø¦Ø¬Ùƒ ÙˆÙŠÙ‚ØªØ±Ø­ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§ØªØŒ ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ³Ø¹ÙŠØ±ØŒ ÙˆØ²ÙŠØ§Ø¯Ø© Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ â€” Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø¯Ø§Ø±Ø¬Ø©.</p>
        </div>
        <div class="feature-card glass">
          <div class="text-4xl mb-5">ğŸ“Š</div>
          <h3 class="text-xl font-bold mb-3">Ù…Ø®Ø·Ø·Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ©</h3>
          <p class="text-gray-400 leading-relaxed">Ø´Ø§Ù‡Ø¯ ØªÙˆØ²ÙŠØ¹ ØªÙƒØ§Ù„ÙŠÙÙƒ Ø¨ØµØ±ÙŠØ§Ù‹ØŒ ÙˆÙ‚Ø§Ø±Ù† Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØªØ³Ø¹ÙŠØ± Ø§Ù„Ù…Ø®ØªÙ„ÙØ© Ù„Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø± Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª.</p>
        </div>
        <div class="feature-card glass">
          <div class="text-4xl mb-5">ğŸ‡²ğŸ‡¦</div>
          <h3 class="text-xl font-bold mb-3">Ù…ÙØ¹Ø¯Ù‘Ù„ Ù„Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ØºØ±Ø¨ÙŠ</h3>
          <p class="text-gray-400 leading-relaxed">ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¯Ø±Ù‡Ù… Ø§Ù„Ù…ØºØ±Ø¨ÙŠØŒ Ù…Ø¹Ø¯Ù„Ø§Øª TVA Ø§Ù„Ù…ØºØ±Ø¨ÙŠØ©ØŒ ÙˆØ£Ø³Ø¹Ø§Ø± Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ø«Ù„ Amana ÙˆAmex.</p>
        </div>
        <div class="feature-card glass" style="border-color: rgba(245,200,66,0.2)">
          <div class="text-4xl mb-5">ğŸ</div>
          <h3 class="text-xl font-bold mb-3">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h3>
          <p class="text-gray-400 leading-relaxed">Ø§Ø±Ø¨Ø­ Ø±ØµÙŠØ¯Ø§Ù‹ Ù…Ø¬Ø§Ù†ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙƒÙ„ ØµØ¯ÙŠÙ‚ ØªØ¯Ø¹ÙˆÙ‡. 50 Ø±ØµÙŠØ¯ Ù„Ùƒ ÙˆÙ„ØµØ§Ø­Ø¨Ùƒ Ø¹Ù†Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ø±Ø§Ø¨Ø·Ùƒ Ø§Ù„Ø®Ø§Øµ.</p>
        </div>
        <div class="feature-card glass">
          <div class="text-4xl mb-5">ğŸ”’</div>
          <h3 class="text-xl font-bold mb-3">Ø¢Ù…Ù† ÙˆÙ…Ø´ÙÙ‘Ø±</h3>
          <p class="text-gray-400 leading-relaxed">Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø´ÙÙ‘Ø±Ø© ÙˆÙ…Ø­Ù…ÙŠØ© Ø¨Ù€ Supabase. Ù„Ø§ Ù…Ø´Ø§Ø±ÙƒØ© Ù…Ø¹ Ø£ÙŠ Ø·Ø±Ù Ø«Ø§Ù„Ø«. Ø®ØµÙˆØµÙŠØªÙƒ Ø£ÙˆÙ„ÙˆÙŠØªÙ†Ø§.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- PRICING -->
  <div id="pricing" class="py-20 px-6">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-16">
        <h2 class="text-4xl font-black mb-4">Ø®Ø·Ø· <span class="grad-text">Ø´ÙØ§ÙØ©</span></h2>
        <p class="text-gray-400">Ù„Ø§ Ø¹Ù‚ÙˆØ¯. Ù„Ø§ Ù…ÙØ§Ø¬Ø¢Øª.</p>
      </div>
      <div class="grid md:grid-cols-2 gap-8">
        <div class="feature-card glass text-center">
          <div class="text-5xl mb-4">ğŸ†“</div>
          <h3 class="text-2xl font-black mb-2">Ù…Ø¬Ø§Ù†ÙŠ</h3>
          <div class="text-4xl font-black grad-text mb-6">0 Ø¯Ø±Ù‡Ù…</div>
          <ul class="text-right space-y-3 mb-8 text-gray-300">
            <li>âœ… 100 Ø±ØµÙŠØ¯ AI Ù…Ø¬Ø§Ù†ÙŠ</li>
            <li>âœ… Ø¬Ù…ÙŠØ¹ Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</li>
            <li>âœ… Ù…Ø®Ø·Ø·Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ©</li>
            <li>âœ… Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</li>
            <li class="text-gray-500">âŒ ØªØµØ¯ÙŠØ± PDF</li>
          </ul>
          <button class="btn-outline w-full py-3" onclick="openModal('authModal','signup')">Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ø§Ù‹</button>
        </div>
        <div class="feature-card glass text-center glow-teal relative overflow-hidden" style="border-color: rgba(0,201,177,0.3)">
          <div class="absolute top-4 left-4 bg-teal-500 text-black text-xs font-bold px-3 py-1 rounded-full">Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ø§Ù‹</div>
          <div class="text-5xl mb-4">ğŸ’</div>
          <h3 class="text-2xl font-black mb-2">Ø¨Ø±Ùˆ</h3>
          <div class="text-4xl font-black mb-1" style="color:var(--teal)">99 <span class="text-2xl">Ø¯Ø±Ù‡Ù…</span></div>
          <p class="text-gray-500 text-sm mb-6">Ø´Ù‡Ø±ÙŠØ§Ù‹</p>
          <ul class="text-right space-y-3 mb-8 text-gray-300">
            <li>âœ… 1000 Ø±ØµÙŠØ¯ AI Ø´Ù‡Ø±ÙŠØ§Ù‹</li>
            <li>âœ… ÙƒÙ„ Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ</li>
            <li>âœ… ØªØµØ¯ÙŠØ± PDF ØªÙØµÙŠÙ„ÙŠ</li>
            <li>âœ… Ø­ÙØ¸ 50 Ù…Ù†ØªØ¬</li>
            <li>âœ… ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</li>
          </ul>
          <button class="btn-primary w-full py-3" onclick="handleCTAClick()">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
        </div>
      </div>
    </div>
  </div>

  <!-- CTA Banner -->
  <div class="py-20 px-6">
    <div class="max-w-4xl mx-auto glass rounded-3xl p-12 text-center glow-gold" style="border-color: rgba(245,200,66,0.2)">
      <h2 class="text-4xl font-black mb-4">Ø¬Ø§Ù‡Ø² ØªØ¹Ø±Ù Ø±Ø¨Ø­Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŸ ğŸ’°</h2>
      <p class="text-gray-400 text-lg mb-8">Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù† ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 100 Ø±ØµÙŠØ¯ AI Ù…Ø¬Ø§Ù†Ø§Ù‹. Ø¨Ø¯ÙˆÙ† Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©.</p>
      <button class="btn-gold text-xl px-12 py-5 rounded-2xl" onclick="openModal('authModal','signup')">
        Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ø§Ù‹ Ø§Ù„Ø¢Ù†
      </button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="border-t border-white/5 py-10 px-6">
    <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="flex items-center gap-3">
        <span class="text-xl font-black grad-text">Ø±Ø¨Ø­ÙŠ</span>
        <span class="text-gray-600 text-sm">Â© 2024 Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</span>
      </div>
      <div class="flex gap-6 text-sm text-gray-500">
        <a href="#" class="hover:text-white transition">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
        <a href="#" class="hover:text-white transition">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
        <a href="#" class="hover:text-white transition">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
      </div>
    </div>
  </footer>

</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CALCULATOR SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="calculatorSection" class="hidden pt-24 pb-16 px-4">
  <div class="max-w-7xl mx-auto">

    <!-- Page header -->
    <div class="mb-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
      <div>
        <h1 class="text-3xl font-black grad-text">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø°ÙƒÙŠØ©</h1>
        <p class="text-gray-400 mt-1">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†ØªØ¬Ùƒ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„</p>
      </div>
      <div class="flex items-center gap-3">
        <span class="token-badge">ğŸª™ <span id="calcTokens">100</span> Ø±ØµÙŠØ¯ Ù…ØªØ¨Ù‚ÙŠ</span>
        <button class="btn-outline text-sm py-2 px-4" onclick="showReferral()">ğŸ Ø§ÙƒØ³Ø¨ Ø±ØµÙŠØ¯Ø§Ù‹</button>
      </div>
    </div>

    <div class="grid lg:grid-cols-5 gap-6">

      <!-- â”€â”€ LEFT: Input Form â”€â”€ -->
      <div class="lg:col-span-2 space-y-5">

        <!-- Product Info -->
        <div class="glass rounded-2xl p-6">
          <h3 class="font-bold text-lg mb-5 flex items-center gap-2">ğŸ“¦ <span>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬</span></h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm text-gray-400 mb-1">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
              <input type="text" id="productName" class="input-field" placeholder="Ù…Ø«Ø§Ù„: Ù‚Ù…ÙŠØµ Ø±Ø¬Ø§Ù„ÙŠ" value="Ù‚Ù…ÙŠØµ Ø±Ø¬Ø§Ù„ÙŠ Ù‚Ø·Ù†ÙŠ" />
            </div>
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-sm text-gray-400 mb-1">Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ (Ø¯.Ù….)</label>
                <input type="number" id="costPrice" class="input-field" value="80" min="0" step="0.01" oninput="calculate()" />
              </div>
              <div>
                <label class="block text-sm text-gray-400 mb-1">Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ (Ø¯.Ù….)</label>
                <input type="number" id="salePrice" class="input-field" value="200" min="0" step="0.01" oninput="calculate()" />
              </div>
            </div>
            <div>
              <label class="block text-sm text-gray-400 mb-1">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</label>
              <input type="number" id="quantity" class="input-field" value="100" min="1" oninput="calculate()" />
            </div>
          </div>
        </div>

        <!-- Costs -->
        <div class="glass rounded-2xl p-6">
          <h3 class="font-bold text-lg mb-5 flex items-center gap-2">ğŸšš <span>Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</span></h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm text-gray-400 mb-1">ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù† Ù„Ù„Ø·Ù„Ø¨ (Ø¯.Ù….)</label>
              <input type="number" id="shippingCost" class="input-field" value="25" min="0" oninput="calculate()" />
            </div>
            <div>
              <label class="block text-sm text-gray-400 mb-1">ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ¹Ø¨Ø¦Ø© ÙˆØ§Ù„ØªØºÙ„ÙŠÙ (Ø¯.Ù….)</label>
              <input type="number" id="packagingCost" class="input-field" value="5" min="0" oninput="calculate()" />
            </div>
            <div>
              <label class="block text-sm text-gray-400 mb-1">ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ù„Ù„Ø·Ù„Ø¨ (Ø¯.Ù….)</label>
              <input type="number" id="marketingCost" class="input-field" value="15" min="0" oninput="calculate()" />
            </div>
            <div>
              <label class="block text-sm text-gray-400 mb-1">ØªÙƒØ§Ù„ÙŠÙ Ø£Ø®Ø±Ù‰ (Ø¯.Ù….)</label>
              <input type="number" id="otherCosts" class="input-field" value="0" min="0" oninput="calculate()" />
            </div>
          </div>
        </div>

        <!-- Tax & Returns -->
        <div class="glass rounded-2xl p-6">
          <h3 class="font-bold text-lg mb-5 flex items-center gap-2">âš–ï¸ <span>Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ ÙˆØ§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</span></h3>
          <div class="space-y-5">
            <div>
              <div class="flex justify-between items-center mb-2">
                <label class="text-sm text-gray-400">Ø¶Ø±ÙŠØ¨Ø© TVA (%)</label>
                <span class="text-white font-bold" id="tvaDisplay">20%</span>
              </div>
              <div class="flex gap-2 mb-2">
                <button class="tab-btn text-xs active" onclick="setTVA(0,this)">0%</button>
                <button class="tab-btn text-xs" onclick="setTVA(7,this)">7%</button>
                <button class="tab-btn text-xs" onclick="setTVA(10,this)">10%</button>
                <button class="tab-btn text-xs" onclick="setTVA(14,this)">14%</button>
                <button class="tab-btn text-xs" onclick="setTVA(20,this)">20%</button>
              </div>
              <input type="range" id="tvaRate" min="0" max="30" value="20" step="1" oninput="onTVASlider(this.value)" />
            </div>

            <div>
              <div class="flex justify-between items-center mb-2">
                <label class="text-sm text-gray-400">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© (%)</label>
                <span id="returnRateDisplay" class="font-bold" style="color:var(--danger)">15%</span>
              </div>
              <input type="range" id="returnRate" min="0" max="60" value="15" step="1" oninput="onReturnSlider(this.value); calculate()" />
              <div class="flex justify-between text-xs text-gray-600 mt-1">
                <span>0%</span><span>Ù…Ù†Ø®ÙØ¶: 5-15%</span><span>Ù…Ø±ØªÙØ¹: +30%</span>
              </div>
            </div>

            <div>
              <div class="flex justify-between items-center mb-2">
                <label class="text-sm text-gray-400">ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„ÙˆØ§Ø­Ø¯ (Ø¯.Ù….)</label>
                <span class="text-white font-bold" id="returnCostDisplay">20</span>
              </div>
              <input type="range" id="returnCost" min="0" max="100" value="20" step="5" oninput="document.getElementById('returnCostDisplay').textContent=this.value; calculate()" />
            </div>
          </div>
        </div>

        <button class="btn-primary w-full py-4 text-lg" onclick="calculate()">
          âœ¨ Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¢Ù†
        </button>
      </div>

      <!-- â”€â”€ RIGHT: Results â”€â”€ -->
      <div class="lg:col-span-3 space-y-5">

        <!-- Summary Cards -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="summaryCards">
          <div class="result-card glass profit">
            <p class="text-xs text-gray-400 mb-1">Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</p>
            <p class="text-2xl font-black" style="color:var(--teal)" id="netProfit">â€”</p>
            <p class="text-xs text-gray-500" id="netProfitSub">Ø¯.Ù….</p>
          </div>
          <div class="result-card glass neutral">
            <p class="text-xs text-gray-400 mb-1">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</p>
            <p class="text-2xl font-black" style="color:var(--gold)" id="profitMargin">â€”</p>
            <p class="text-xs text-gray-500">% Ù…Ù† Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯</p>
          </div>
          <div class="result-card glass neutral">
            <p class="text-xs text-gray-400 mb-1">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯</p>
            <p class="text-2xl font-black text-white" id="grossRevenue">â€”</p>
            <p class="text-xs text-gray-500">Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</p>
          </div>
          <div class="result-card glass loss">
            <p class="text-xs text-gray-400 mb-1">Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</p>
            <p class="text-2xl font-black" style="color:var(--danger)" id="returnLoss">â€”</p>
            <p class="text-xs text-gray-500">Ø¯.Ù….</p>
          </div>
        </div>

        <!-- Profit Meter -->
        <div class="glass rounded-2xl p-5">
          <div class="flex justify-between items-center mb-3">
            <span class="text-sm font-semibold">Ù…Ù‚ÙŠØ§Ø³ ØµØ­Ø© Ø§Ù„Ø±Ø¨Ø­ÙŠØ©</span>
            <span id="healthLabel" class="text-sm font-bold text-teal-400">Ù…Ù…ØªØ§Ø²</span>
          </div>
          <div class="profit-meter">
            <div class="profit-meter-fill" id="profitMeterFill" style="width:0%; background: linear-gradient(90deg,var(--danger),var(--gold),var(--teal))"></div>
          </div>
          <div class="flex justify-between text-xs text-gray-600 mt-1">
            <span>Ø®Ø§Ø³Ø±</span><span>Ù…Ù‚Ø¨ÙˆÙ„</span><span>Ù…Ù…ØªØ§Ø²</span>
          </div>
        </div>

        <!-- Chart -->
        <div class="glass rounded-2xl p-6">
          <div class="flex gap-2 mb-5">
            <button class="tab-btn active text-sm" onclick="switchChart('doughnut',this)">ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</button>
            <button class="tab-btn text-sm" onclick="switchChart('bar',this)">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ</button>
          </div>
          <div class="relative" style="height:240px;">
            <canvas id="mainChart"></canvas>
          </div>
        </div>

        <!-- Breakdown Table -->
        <div class="glass rounded-2xl p-6">
          <h3 class="font-bold text-lg mb-4">ğŸ“‹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©</h3>
          <table class="breakdown-table">
            <thead>
              <tr>
                <th>Ø§Ù„Ø¨Ù†Ø¯</th>
                <th class="text-left">Ù„Ù„ÙˆØ­Ø¯Ø© (Ø¯.Ù….)</th>
                <th class="text-left">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø¯.Ù….)</th>
              </tr>
            </thead>
            <tbody id="breakdownBody">
              <tr><td colspan="3" class="text-center text-gray-500 py-4">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</td></tr>
            </tbody>
          </table>
        </div>

        <!-- AI Recommendations -->
        <div class="glass rounded-2xl p-6" id="aiSection">
          <div class="flex justify-between items-center mb-5">
            <h3 class="font-bold text-lg flex items-center gap-2">ğŸ¤– <span>ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span></h3>
            <span class="token-badge text-xs">ÙŠÙƒÙ„Ù 1 ğŸª™</span>
          </div>

          <div id="aiContent">
            <p class="text-gray-400 text-sm mb-5 leading-relaxed">
              Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ Ø´Ø®ØµÙŠ Ù…Ù† Ù†Ù…ÙˆØ°Ø¬ Llama 3 Ø§Ù„Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØºØ±Ø¨ÙŠØ©.
            </p>
            <button class="btn-primary w-full py-3" onclick="getAIAdvice()">
              âœ¨ Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªÙˆØµÙŠØ© Ø°ÙƒÙŠØ©
            </button>
          </div>

          <div id="aiLoading" class="hidden text-center py-8">
            <div class="loading-dots mb-4">
              <span></span><span></span><span></span>
            </div>
            <p class="text-gray-400 text-sm">Llama 3 ÙŠØ­Ù„Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ...</p>
          </div>

          <div id="aiResult" class="hidden">
            <div class="ai-bubble text-sm text-gray-300" id="aiText"></div>
            <div class="flex justify-between items-center mt-4">
              <button class="btn-outline text-sm py-2 px-4" onclick="getAIAdvice()">ğŸ”„ ØªØ­Ù„ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
              <button class="btn-outline text-sm py-2 px-4" onclick="copyAIText()">ğŸ“‹ Ù†Ø³Ø®</button>
            </div>
          </div>
        </div>

        <!-- Referral Box -->
        <div id="referralBox" class="referral-box">
          <div class="flex items-center gap-3 mb-3">
            <span class="text-2xl">ğŸ</span>
            <div>
              <p class="font-bold">Ø§Ø±Ø¨Ø­ Ø±ØµÙŠØ¯Ø§Ù‹ Ù…Ø¬Ø§Ù†ÙŠØ§Ù‹!</p>
              <p class="text-sm text-gray-400">50 Ø±ØµÙŠØ¯ Ù„Ùƒ ÙˆÙ„ØµØ§Ø­Ø¨Ùƒ Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„Ù‡ Ø¨Ø±Ø§Ø¨Ø·Ùƒ</p>
            </div>
          </div>
          <div class="referral-link mb-3" id="referralLinkDisplay">Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø¹Ø±Ø¶ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</div>
          <button class="btn-outline text-sm py-2 px-4 w-full" onclick="copyReferral()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
        </div>

      </div><!-- /right col -->
    </div><!-- /grid -->
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     DASHBOARD SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section id="dashboardSection" class="hidden pt-24 pb-16 px-4">
  <div class="max-w-5xl mx-auto">
    <div class="mb-10">
      <h1 class="text-3xl font-black grad-text">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
      <p class="text-gray-400 mt-1">Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙƒ ÙˆØªØ§Ø±ÙŠØ® Ø­Ø³Ø§Ø¨Ø§ØªÙƒ</p>
    </div>

    <div class="grid md:grid-cols-3 gap-6 mb-8">
      <div class="glass rounded-2xl p-6 text-center">
        <p class="text-gray-400 text-sm mb-2">Ø±ØµÙŠØ¯ AI Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</p>
        <p class="text-4xl font-black grad-text" id="dashTokens">â€”</p>
      </div>
      <div class="glass rounded-2xl p-6 text-center">
        <p class="text-gray-400 text-sm mb-2">Ø¹Ù…Ù„ÙŠØ§Øª Ø­Ø³Ø§Ø¨ÙŠØ©</p>
        <p class="text-4xl font-black" style="color:var(--teal)">0</p>
      </div>
      <div class="glass rounded-2xl p-6 text-center">
        <p class="text-gray-400 text-sm mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</p>
        <p class="text-4xl font-black" style="color:var(--gold)" id="dashReferrals">0</p>
      </div>
    </div>

    <div class="glass rounded-2xl p-6 mb-6">
      <h3 class="font-bold text-lg mb-5">Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h3>
      <div class="referral-box">
        <p class="text-sm text-gray-300 mb-3">Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:</p>
        <div class="referral-link mb-3" id="dashReferralLink">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        <div class="flex gap-3">
          <button class="btn-gold flex-1 py-2 text-sm" onclick="copyReferral()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
          <button class="btn-outline flex-1 py-2 text-sm" onclick="shareReferral()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
        </div>
      </div>
    </div>

    <div class="glass rounded-2xl p-6">
      <h3 class="font-bold text-lg mb-4">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</h3>
      <div class="space-y-3 text-sm">
        <div class="flex justify-between py-2 border-b border-white/5">
          <span class="text-gray-400">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</span>
          <span id="dashEmail">â€”</span>
        </div>
        <div class="flex justify-between py-2 border-b border-white/5">
          <span class="text-gray-400">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</span>
          <span id="dashCreated">â€”</span>
        </div>
        <div class="flex justify-between py-2">
          <span class="text-gray-400">Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</span>
          <span class="token-badge text-xs">Ù…Ø¬Ø§Ù†ÙŠ</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIG â€” Replace with your keys
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SUPABASE_URL  = 'https://ddfbnijygwrrghdrbici.supabase.co';
const SUPABASE_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkZmJuaWp5Z3dycmdoZHJiaWNpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIyOTcxOTUsImV4cCI6MjA4Nzg3MzE5NX0.c6OnX0iTbFS44PmBhZdrQmMa4sohR3J6h2aMRdH9QqQ';
const GROQ_API_KEY  = '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';

// Init Supabase
const { createClient } = supabase;
const sb = createClient(SUPABASE_URL, SUPABASE_ANON);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentUser   = null;
let userProfile   = null;
let userTokens    = 100;
let calcResults   = null;
let mainChart     = null;
let currentTab    = 'login';
let tvaRateValue  = 20;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('DOMContentLoaded', async () => {
  // Check URL for referral code
  const urlParams = new URLSearchParams(window.location.search);
  const refParam  = urlParams.get('ref');
  if (refParam) {
    document.getElementById('refCode').value = refParam;
    switchAuthTab('signup');
  }

  // Listen to auth changes
  sb.auth.onAuthStateChange(async (event, session) => {
    if (session?.user) {
      currentUser = session.user;
      await loadUserProfile();
      showAuthUI(true);
    } else {
      currentUser = null;
      userProfile = null;
      showAuthUI(false);
    }
  });

  // Initial calculation
  calculate();

  // Animate hero elements
  document.querySelectorAll('.fade-up').forEach(el => {
    el.style.opacity = '1';
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showSection(name) {
  document.getElementById('landingSection').classList.add('hidden');
  document.getElementById('calculatorSection').classList.add('hidden');
  document.getElementById('dashboardSection').classList.add('hidden');

  if (name === 'landing')    document.getElementById('landingSection').classList.remove('hidden');
  if (name === 'calculator') {
    if (!currentUser) { openModal('authModal','login'); return; }
    document.getElementById('calculatorSection').classList.remove('hidden');
    calculate();
  }
  if (name === 'dashboard') {
    if (!currentUser) { openModal('authModal','login'); return; }
    document.getElementById('dashboardSection').classList.remove('hidden');
    loadDashboard();
  }
}

function handleCTAClick() {
  if (currentUser) showSection('calculator');
  else openModal('authModal','signup');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(id, tab) {
  document.getElementById(id).classList.add('open');
  if (tab) switchAuthTab(tab);
}
function closeModal(id) { document.getElementById(id).classList.remove('open'); }
function handleModalOverlayClick(e) {
  if (e.target === e.currentTarget) closeModal('authModal');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH TAB SWITCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchAuthTab(tab) {
  currentTab = tab;
  document.getElementById('tab-login').classList.toggle('active', tab === 'login');
  document.getElementById('tab-signup').classList.toggle('active', tab === 'signup');
  document.getElementById('nameField').classList.toggle('hidden', tab !== 'signup');
  document.getElementById('refField').classList.toggle('hidden', tab !== 'signup');
  document.getElementById('authTitle').textContent = tab === 'login' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨';
  document.getElementById('authBtnText').textContent = tab === 'login' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH HANDLER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function handleAuth(e) {
  e.preventDefault();
  const email    = document.getElementById('authEmail').value.trim();
  const password = document.getElementById('authPassword').value;
  const name     = document.getElementById('authName').value.trim();
  const refCode  = document.getElementById('refCode').value.trim();
  const btn      = document.getElementById('authSubmit');

  btn.disabled = true;
  btn.innerHTML = '<span class="loading-dots"><span></span><span></span><span></span></span>';

  try {
    if (currentTab === 'signup') {
      // Sign up
      const { data, error } = await sb.auth.signUp({
        email, password,
        options: { data: { full_name: name } }
      });
      if (error) throw error;

      // Create profile with 100 free tokens
      if (data.user) {
        const referralCode = 'REF-' + data.user.id.substring(0,6).toUpperCase();
        await sb.from('profiles').insert({
          id: data.user.id,
          email,
          full_name: name || email.split('@')[0],
          tokens: 100,
          referral_code: referralCode,
          referred_by: refCode || null,
          created_at: new Date().toISOString()
        });
        // If referred, reward both users
        if (refCode) {
          await sb.rpc('reward_referral', { ref_code: refCode, new_user_id: data.user.id });
        }
      }
      showToast('ğŸ‰ Ù…Ø±Ø­Ø¨Ø§Ù‹! ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨Ø±ÙŠØ¯Ùƒ Ù„Ù„ØªØ£ÙƒÙŠØ¯');

    } else {
      // Sign in
      const { error } = await sb.auth.signInWithPassword({ email, password });
      if (error) throw error;
      showToast('ğŸ‘‹ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ!');
    }
    closeModal('authModal');
    showSection('calculator');
  } catch (err) {
    showToast('âŒ ' + (err.message || 'Ø­Ø¯Ø« Ø®Ø·Ø£'), true);
  } finally {
    btn.disabled = false;
    btn.innerHTML = '<span id="authBtnText">' + (currentTab === 'login' ? 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„' : 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨') + '</span>';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIGN OUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function handleSignOut() {
  await sb.auth.signOut();
  currentUser = null;
  showAuthUI(false);
  showSection('landing');
  showToast('ğŸ‘‹ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOAD USER PROFILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadUserProfile() {
  if (!currentUser) return;
  const { data } = await sb.from('profiles').select('*').eq('id', currentUser.id).single();
  if (data) {
    userProfile = data;
    userTokens = data.tokens || 0;
    updateTokenDisplay();
    const initial = (data.full_name || data.email || 'Ù…').charAt(0).toUpperCase();
    document.getElementById('navAvatar').textContent = initial;
    document.getElementById('navUserEmail').textContent = data.email || currentUser.email;
    // Set referral link
    const refLink = window.location.origin + window.location.pathname + '?ref=' + data.referral_code;
    document.getElementById('referralLinkDisplay').textContent = refLink;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SHOW AUTH UI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showAuthUI(loggedIn) {
  document.getElementById('navGuest').classList.toggle('hidden', loggedIn);
  document.getElementById('navUser').classList.toggle('hidden', !loggedIn);
  document.getElementById('navUser').classList.toggle('flex', loggedIn);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UPDATE TOKEN DISPLAY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateTokenDisplay() {
  document.getElementById('navTokens').textContent = userTokens;
  document.getElementById('calcTokens').textContent = userTokens;
  if (document.getElementById('dashTokens'))
    document.getElementById('dashTokens').textContent = userTokens;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TVA CONTROLS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setTVA(val, btn) {
  tvaRateValue = val;
  document.getElementById('tvaRate').value = val;
  document.getElementById('tvaDisplay').textContent = val + '%';
  document.querySelectorAll('.tab-btn[onclick^="setTVA"]').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  calculate();
}
function onTVASlider(val) {
  tvaRateValue = parseInt(val);
  document.getElementById('tvaDisplay').textContent = val + '%';
  document.querySelectorAll('.tab-btn[onclick^="setTVA"]').forEach(b => b.classList.remove('active'));
  calculate();
}
function onReturnSlider(val) {
  const display = document.getElementById('returnRateDisplay');
  display.textContent = val + '%';
  const v = parseInt(val);
  display.style.color = v < 10 ? 'var(--teal)' : v < 25 ? 'var(--gold)' : 'var(--danger)';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN CALCULATOR â€” Risk-Adjusted
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function calculate() {
  const costPrice     = parseFloat(document.getElementById('costPrice').value) || 0;
  const salePrice     = parseFloat(document.getElementById('salePrice').value) || 0;
  const qty           = parseInt(document.getElementById('quantity').value) || 0;
  const shippingCost  = parseFloat(document.getElementById('shippingCost').value) || 0;
  const packagingCost = parseFloat(document.getElementById('packagingCost').value) || 0;
  const marketingCost = parseFloat(document.getElementById('marketingCost').value) || 0;
  const otherCosts    = parseFloat(document.getElementById('otherCosts').value) || 0;
  const tvaRate       = tvaRateValue / 100;
  const returnRate    = parseFloat(document.getElementById('returnRate').value) / 100 || 0;
  const returnCostPer = parseFloat(document.getElementById('returnCost').value) || 0;

  // â”€â”€ Risk-Adjusted Calculation â”€â”€
  const soldUnits     = qty * (1 - returnRate);
  const returnedUnits = qty * returnRate;

  // Revenue (only from actually kept sales, net of TVA)
  const revenueGross  = salePrice * soldUnits;
  const tvaAmount     = revenueGross * tvaRate;
  const revenueNet    = revenueGross - tvaAmount;

  // Total costs (for ALL units ordered, incl. returned)
  const totalCostGoods   = costPrice * qty;
  const totalShipping    = shippingCost * qty;
  const totalPackaging   = packagingCost * qty;
  const totalMarketing   = marketingCost * soldUnits; // only for sold
  const totalOther       = otherCosts * qty;
  const totalReturnCost  = returnCostPer * returnedUnits;

  const totalCosts = totalCostGoods + totalShipping + totalPackaging + totalMarketing + totalOther + totalReturnCost;

  // Net Profit
  const netProfit    = revenueNet - totalCosts;
  const profitMargin = revenueNet > 0 ? (netProfit / revenueNet) * 100 : 0;
  const profitPerUnit = soldUnits > 0 ? netProfit / soldUnits : 0;
  const ROI          = totalCosts > 0 ? (netProfit / totalCosts) * 100 : 0;

  calcResults = {
    costPrice, salePrice, qty, soldUnits, returnedUnits,
    shippingCost, packagingCost, marketingCost, otherCosts,
    tvaRate, tvaRateValue, returnRate, returnCostPer,
    revenueGross, tvaAmount, revenueNet,
    totalCostGoods, totalShipping, totalPackaging, totalMarketing, totalOther, totalReturnCost,
    totalCosts, netProfit, profitMargin, profitPerUnit, ROI
  };

  // â”€â”€ Update UI â”€â”€
  const fmt = n => n.toLocaleString('ar-MA', { maximumFractionDigits: 0 });

  document.getElementById('netProfit').textContent    = fmt(netProfit) + ' Ø¯.Ù….';
  document.getElementById('netProfit').style.color    = netProfit >= 0 ? 'var(--teal)' : 'var(--danger)';
  document.getElementById('profitMargin').textContent = profitMargin.toFixed(1) + '%';
  document.getElementById('profitMargin').style.color = profitMargin >= 20 ? 'var(--teal)' : profitMargin >= 5 ? 'var(--gold)' : 'var(--danger)';
  document.getElementById('grossRevenue').textContent = fmt(revenueNet) + ' Ø¯.Ù….';
  document.getElementById('returnLoss').textContent   = fmt(totalReturnCost + (salePrice * returnedUnits)) + ' Ø¯.Ù….';

  // Profit meter
  const health = Math.max(0, Math.min(100, profitMargin + 10));
  document.getElementById('profitMeterFill').style.width = health + '%';
  document.getElementById('healthLabel').textContent =
    profitMargin >= 30 ? 'Ù…Ù…ØªØ§Ø² ğŸŒŸ' : profitMargin >= 15 ? 'Ø¬ÙŠØ¯ âœ…' : profitMargin >= 5 ? 'Ù…Ù‚Ø¨ÙˆÙ„ âš ï¸' : profitMargin >= 0 ? 'Ø¶Ø¹ÙŠÙ ğŸ”´' : 'Ø®Ø³Ø§Ø±Ø© âŒ';
  document.getElementById('healthLabel').style.color =
    profitMargin >= 30 ? 'var(--teal)' : profitMargin >= 15 ? '#7ee787' : profitMargin >= 0 ? 'var(--gold)' : 'var(--danger)';

  // Breakdown table
  const rows = [
    ['Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ Ù„Ù„ÙˆØ­Ø¯Ø©', salePrice, salePrice * soldUnits, '#e8f0ff'],
    ['Ø¶Ø±ÙŠØ¨Ø© TVA (' + tvaRateValue + '%)', -(salePrice * tvaRate), -(tvaAmount), 'var(--danger)'],
    ['ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©', -costPrice, -totalCostGoods, 'var(--danger)'],
    ['ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù†', -shippingCost, -totalShipping, 'var(--danger)'],
    ['ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ¹Ø¨Ø¦Ø©', -packagingCost, -totalPackaging, 'var(--danger)'],
    ['ØªÙƒÙ„ÙØ© Ø§Ù„ØªØ³ÙˆÙŠÙ‚', -marketingCost, -totalMarketing, 'var(--danger)'],
    ['Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª', -(returnCostPer + salePrice) * returnRate, -(totalReturnCost + salePrice * returnedUnits), 'var(--danger)'],
    ['ØªÙƒØ§Ù„ÙŠÙ Ø£Ø®Ø±Ù‰', -otherCosts, -totalOther, 'var(--danger)'],
  ];
  const tbody = document.getElementById('breakdownBody');
  tbody.innerHTML = rows.map(([label, unit, total, color]) =>
    `<tr>
      <td>${label}</td>
      <td class="text-left font-mono" style="color:${unit >= 0 ? 'var(--teal)' : 'var(--danger)'}">
        ${unit >= 0 ? '+' : ''}${Math.abs(unit).toFixed(2)}
      </td>
      <td class="text-left font-mono font-bold" style="color:${total >= 0 ? 'var(--teal)' : 'var(--danger)'}">
        ${total >= 0 ? '+' : ''}${Math.abs(Math.round(total)).toLocaleString('ar-MA')}
      </td>
    </tr>`
  ).join('') +
  `<tr style="border-top: 2px solid rgba(255,255,255,0.1);">
    <td class="font-black">ğŸ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</td>
    <td class="text-left font-mono font-black" style="color:${profitPerUnit >= 0 ? 'var(--teal)' : 'var(--danger)'}">
      ${profitPerUnit >= 0 ? '+' : ''}${Math.abs(profitPerUnit).toFixed(2)}
    </td>
    <td class="text-left font-mono font-black text-base" style="color:${netProfit >= 0 ? 'var(--teal)' : 'var(--danger)'}">
      ${netProfit >= 0 ? '+' : ''}${Math.abs(Math.round(netProfit)).toLocaleString('ar-MA')} Ø¯.Ù….
    </td>
  </tr>`;

  updateChart();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentChartType = 'doughnut';

function switchChart(type, btn) {
  currentChartType = type;
  document.querySelectorAll('.tab-btn[onclick^="switchChart"]').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  if (mainChart) { mainChart.destroy(); mainChart = null; }
  updateChart();
}

function updateChart() {
  if (!calcResults) return;
  const ctx = document.getElementById('mainChart').getContext('2d');
  if (mainChart) { mainChart.destroy(); mainChart = null; }

  if (currentChartType === 'doughnut') {
    const d = calcResults;
    mainChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©','Ø§Ù„Ø´Ø­Ù†','Ø§Ù„ØªØ¹Ø¨Ø¦Ø©','Ø§Ù„ØªØ³ÙˆÙŠÙ‚','TVA','Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª','Ø§Ù„Ø±Ø¨Ø­'],
        datasets: [{
          data: [
            Math.abs(d.totalCostGoods),
            Math.abs(d.totalShipping),
            Math.abs(d.totalPackaging),
            Math.abs(d.totalMarketing),
            Math.abs(d.tvaAmount),
            Math.abs(d.totalReturnCost),
            Math.max(0, d.netProfit)
          ],
          backgroundColor: [
            '#ef4444','#f97316','#eab308','#a855f7','#3b82f6','#ff4d6d','#00c9b1'
          ],
          borderWidth: 0,
          hoverOffset: 8
        }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          legend: { position: 'right', labels: { color:'#8899b0', font:{ family:'Cairo', size:11 }, padding:12 } },
          tooltip: {
            callbacks: {
              label: (ctx) => ' ' + ctx.label + ': ' + Math.round(ctx.raw).toLocaleString('ar-MA') + ' Ø¯.Ù….'
            }
          }
        },
        cutout: '65%'
      }
    });
  } else {
    // Bar: compare 3 pricing scenarios
    const d = calcResults;
    const basePrice = d.salePrice;
    const scenarios = [-20, 0, 20, 40].map(pct => {
      const price = basePrice * (1 + pct/100);
      const soldUnits = d.soldUnits;
      const rev = price * soldUnits * (1 - d.tvaRate);
      const profit = rev - d.totalCosts + (d.marketingCost * d.soldUnits) - (d.marketingCost * soldUnits);
      return { label: (pct >= 0 ? '+' : '') + pct + '% Ø³Ø¹Ø±', profit: Math.round(profit) };
    });
    mainChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: scenarios.map(s => s.label),
        datasets: [{
          label: 'Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ (Ø¯.Ù….)',
          data: scenarios.map(s => s.profit),
          backgroundColor: scenarios.map(s => s.profit >= 0 ? 'rgba(0,201,177,0.7)' : 'rgba(255,77,109,0.7)'),
          borderRadius: 8,
          borderSkipped: false
        }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: { callbacks: { label: ctx => ' ' + Math.round(ctx.raw).toLocaleString('ar-MA') + ' Ø¯.Ù….' } }
        },
        scales: {
          x: { ticks: { color:'#8899b0', font:{ family:'Cairo' } }, grid: { color:'rgba(255,255,255,0.05)' } },
          y: { ticks: { color:'#8899b0', font:{ family:'Cairo' }, callback: v => v.toLocaleString() }, grid: { color:'rgba(255,255,255,0.05)' } }
        }
      }
    });
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI ADVICE (Groq + Llama 3)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function getAIAdvice() {
  if (!currentUser) { openModal('authModal','login'); return; }
  if (userTokens <= 0) { showToast('âŒ Ø±ØµÙŠØ¯Ùƒ Ù†ÙØ°! Ø£Ø­Ù„ ØµØ¯ÙŠÙ‚Ø§Ù‹ Ù„ØªØ±Ø¨Ø­ Ø±ØµÙŠØ¯Ø§Ù‹', true); return; }
  if (!calcResults)    { showToast('âš ï¸ Ø§Ø­Ø³Ø¨ Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙˆØµÙŠØ©'); return; }

  const d = calcResults;
  const prompt = `Ø£Ù†Øª Ù…Ø³ØªØ´Ø§Ø± ØªØ¬Ø§Ø±Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø®Ø¨ÙŠØ± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…ØºØ±Ø¨ÙŠ. Ø­Ù„Ù‘Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‚Ø¯Ù‘Ù… ØªÙˆØµÙŠØ§Øª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¹Ù…Ù„ÙŠØ© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Ù…Ø²ÙŠØ¬ Ù…Ù† Ø§Ù„ÙØµØ­Ù‰ ÙˆØ§Ù„Ø¯Ø§Ø±Ø¬Ø© Ø§Ù„Ù…ØºØ±Ø¨ÙŠØ©):

ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬: ${document.getElementById('productName').value || 'Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
ğŸ’° Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡: ${d.costPrice} Ø¯Ø±Ù‡Ù… | Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹: ${d.salePrice} Ø¯Ø±Ù‡Ù…
ğŸ“Š Ø§Ù„ÙƒÙ…ÙŠØ©: ${d.qty} ÙˆØ­Ø¯Ø© | Ø§Ù„Ù…Ø¨Ø§Ø¹Ø© ÙØ¹Ù„Ø§Ù‹: ${Math.round(d.soldUnits)} ÙˆØ­Ø¯Ø©
â†©ï¸ Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª: ${(d.returnRate*100).toFixed(0)}% (${Math.round(d.returnedUnits)} ÙˆØ­Ø¯Ø© Ù…Ø±ØªØ¬Ø¹Ø©)
ğŸ’¸ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ: ${Math.round(d.totalCosts)} Ø¯Ø±Ù‡Ù…
ğŸ·ï¸ TVA: ${d.tvaRateValue}% = ${Math.round(d.tvaAmount)} Ø¯Ø±Ù‡Ù…
ğŸ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ: ${Math.round(d.netProfit)} Ø¯Ø±Ù‡Ù…
ğŸ“ˆ Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­: ${d.profitMargin.toFixed(1)}%
ğŸ“¦ Ø®Ø³Ø§Ø±Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª: ${Math.round(d.totalReturnCost)} Ø¯Ø±Ù‡Ù…

Ù‚Ø¯Ù‘Ù… ØªØ­Ù„ÙŠÙ„Ø§Ù‹ ÙÙŠ 4 Ù†Ù‚Ø§Ø·:
1. ğŸš¨ Ø£Ù‡Ù… Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
2. ğŸ’¡ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù„ØªØ®ÙÙŠØ¶ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
3. ğŸ’° ÙƒÙŠÙ ØªØ­Ø³Ù‘Ù† Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹ Ø£Ùˆ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ
4. ğŸ¯ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© Ø§Ù„Ø£Ù‡Ù… Ø§Ù„Ø¢Ù†
ÙƒÙ† Ù…Ø­Ø¯Ø¯Ø§Ù‹ ÙˆØ¹Ù…Ù„ÙŠØ§Ù‹ ÙˆÙ…Ø¨Ø§Ø´Ø±Ø§Ù‹. Ù„Ø§ ØªÙƒØ±Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. Ø£Ø¹Ø·Ù Ù†ØµØ§Ø¦Ø­ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙˆØ±Ø§Ù‹.`;

  // Update UI
  document.getElementById('aiContent').classList.add('hidden');
  document.getElementById('aiResult').classList.add('hidden');
  document.getElementById('aiLoading').classList.remove('hidden');

  try {
    const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + GROQ_API_KEY
      },
      body: JSON.stringify({
        model: 'qwen/qwen3-32b',
        messages: [{ role: 'user', content: prompt }],
        max_tokens: 600,
        temperature: 0.7
      })
    });

    if (!res.ok) throw new Error('Groq API error: ' + res.status);
    const json  = await res.json();
    const advice = json.choices?.[0]?.message?.content || 'Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆØµÙŠØ©.';

    // Deduct token
    userTokens = Math.max(0, userTokens - 1);
    await sb.from('profiles').update({ tokens: userTokens }).eq('id', currentUser.id);
    updateTokenDisplay();

    // Log usage
    await sb.from('token_usage').insert({
      user_id: currentUser.id,
      action: 'ai_advice',
      product_name: document.getElementById('productName').value,
      tokens_used: 1,
      created_at: new Date().toISOString()
    });

    document.getElementById('aiText').textContent = advice;
    document.getElementById('aiLoading').classList.add('hidden');
    document.getElementById('aiResult').classList.remove('hidden');

  } catch (err) {
    document.getElementById('aiLoading').classList.add('hidden');
    document.getElementById('aiContent').classList.remove('hidden');
    showToast('âŒ ' + (err.message || 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„'), true);
    console.error(err);
  }
}

function copyAIText() {
  const text = document.getElementById('aiText').textContent;
  navigator.clipboard.writeText(text).then(() => showToast('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!'));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REFERRAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showReferral() {
  if (!currentUser) { openModal('authModal','login'); return; }
  showSection('dashboard');
}

function copyReferral() {
  const code = userProfile?.referral_code;
  if (!code) { showToast('âš ï¸ Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  const link = window.location.origin + window.location.pathname + '?ref=' + code;
  navigator.clipboard.writeText(link).then(() => showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©!'));
}

async function shareReferral() {
  const code = userProfile?.referral_code;
  if (!code) return;
  const link = window.location.origin + window.location.pathname + '?ref=' + code;
  const text = `ğŸš€ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø¨Ø­ÙŠ Ù„Ø­Ø³Ø§Ø¨ Ø£Ø±Ø¨Ø§Ø­Ùƒ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©!\nØ³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù† ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 50 Ø±ØµÙŠØ¯ Ù…Ø¬Ø§Ù†ÙŠ: ${link}`;
  if (navigator.share) {
    navigator.share({ title: 'Ø±Ø¨Ø­ÙŠ â€” Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­', text, url: link });
  } else {
    navigator.clipboard.writeText(text).then(() => showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©!'));
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadDashboard() {
  if (!currentUser || !userProfile) return;
  document.getElementById('dashEmail').textContent   = currentUser.email;
  document.getElementById('dashCreated').textContent = new Date(currentUser.created_at).toLocaleDateString('ar-MA');
  document.getElementById('dashTokens').textContent  = userTokens;

  const refLink = window.location.origin + window.location.pathname + '?ref=' + (userProfile.referral_code || '');
  document.getElementById('dashReferralLink').textContent = refLink;

  // Count referrals
  const { count } = await sb.from('profiles').select('*', { count: 'exact', head: true })
    .eq('referred_by', userProfile.referral_code);
  document.getElementById('dashReferrals').textContent = count || 0;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let toastTimer;
function showToast(msg, isError = false) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.borderColor = isError ? 'rgba(255,77,109,0.4)' : 'rgba(0,201,177,0.3)';
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 3500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SMOOTH SCROLL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    const target = document.querySelector(a.getAttribute('href'));
    if (target) { e.preventDefault(); target.scrollIntoView({ behavior:'smooth' }); }
  });
});
</script>
</body>
</html>
